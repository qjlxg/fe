name: ğŸš€ è‡ªåŠ¨åŒæ­¥åˆ†æçœ‹æ¿

on:
  schedule:
    - cron: '30 7 * * *'  # æ¯æ—¥ 15:30
  workflow_dispatch: 

jobs:
  build:
    runs-on: ubuntu-latest
    permissions: # å…³é”®ï¼šæˆäºˆå†™å…¥æƒé™
      contents: write
    steps:
      - uses: actions/checkout@v4
        with:
          persist-credentials: true # ä¿æŒç™»å½•çŠ¶æ€

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Run Analyzer
        run: |
          pip install pandas numpy
          python analyzer_V9.py

      - name: Commit and Push Changes
        run: |
          git config --global user.name "Sky-Pivot-Bot"
          git config --global user.email "actions@github.com"
          
          # æ·»åŠ ç”Ÿæˆçš„æ–‡ä»¶
          git add README.md strategy_log.csv portfolio.csv || true
          
          # æ£€æŸ¥æ˜¯å¦æœ‰å˜åŠ¨
          if [ -z "$(git status --porcelain)" ]; then
            echo "No changes to commit"
            exit 0
          fi
          
          git commit -m "ğŸ“ˆ è‡ªåŠ¨æ›´æ–°çœ‹æ¿ä¸æ—¥å¿—: $(date +'%Y-%m-%d %H:%M')"
          git push origin main
